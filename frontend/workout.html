<!DOCTYPE html>
<html lang="hu">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Edzésterv – ATHLION</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="base.css" />
  <link rel="stylesheet" href="layout.css" />
  <link rel="icon" type="image/png" href="favicon.png">
</head>
<body>
  <header class="topbar glass">
    <div class="brand">
      <a href="dashboard.html" style="display:flex;align-items:center;gap:12px;text-decoration:none;color:inherit">
        <img src="athlion_logo.png" alt="ATHLION logó" />
        <div class="title">ATH<span>LION</span></div>
      </a>
    </div>

    <div class="nav-main-links">
      <a href="diet.html" class="ghost" id="navDiet">Étrend</a>
      <a href="dashboard.html" class="ghost ghost-icon" id="navHome" title="Kezdőlap">
        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" class="nav-icon">
          <path stroke-linecap="round" stroke-linejoin="round" d="M2.25 12l8.954-8.955c.44-.439 1.152-.439 1.591 0L21.75 12M4.5 9.75v10.125c0 .621.504 1.125 1.125 1.125H9.75v-4.875c0-.621.504-1.125 1.125-1.125h2.25c.621 0 1.125.504 1.125 1.125V21h4.125c.621 0 1.125-.504 1.125-1.125V9.75M8.25 21h8.25" />
        </svg>
      </a>
      <a href="workout.html" class="ghost active" id="navWorkout">Edzésterv</a>
    </div>

    <div class="nav-auth-group" style="position: relative;">
    
    <button id="profileDropdownBtn" class="ghost" style="display:flex; align-items:center; gap:8px; padding-right:15px;">
        <span id="navProfileName">Fiók</span>
        <span style="font-size: 0.8em; opacity: 0.7;">▼</span>
    </button>

    <div id="profileMenu" class="dropdown-menu">
        <div class="dropdown-header">
          <span style="font-size:12px; color:var(--muted); text-transform:uppercase; letter-spacing:1px;">Fiók</span>
        </div>
          <a href="profile.html" class="dropdown-item">
            Profil szerkesztése
          </a>
        <div style="height:1px; background:var(--glass-stroke); margin:4px 0;"></div>
          <a href="#" id="navLogout" class="dropdown-item" style="color: var(--err);">
            Kijelentkezés
          </a>
        </div>
  </header>

  <main class="page">
    <section class="panel" id="workout">

      <div class="view-container">

        <!-- NAPTÁR NÉZET – ID igazítva: calendarView, calendarGrid, currentMonthLabel -->
        <div id="calendarView" class="view-section active">
          <section class="card glass calendar-card full-width-calendar">
            <div class="calendar-header-row">
              <h3>Edzésnapló</h3>
              <div class="calendar-controls">
                <button class="cal-nav" id="calendarPrev">‹</button>
                <div class="calendar-month" id="currentMonthLabel">–</div>
                <button class="cal-nav" id="calendarNext">›</button>
              </div>
            </div>

            <div class="calendar-weekdays">
              <span>H</span><span>K</span><span>Sze</span>
              <span>Cs</span><span>P</span><span>Szo</span><span>V</span>
            </div>

            <!-- ID igazítva: calendarGrid -->
            <div class="calendar-grid" id="calendarGrid"></div>
          </section>

          <div class="dashboard-widgets">

            <section class="card glass recovery-card">
              <div class="widget-header">
                <h4>Regeneráció</h4>
                <p>Izmok pihentségi szintje</p>
              </div>
              <div id="recoveryList">
                <p class="muted small">Tölts fel edzéseket az adatokhoz.</p>
              </div>
            </section>

            <section class="card glass stats-card">
              <div class="widget-header">
                <h4>Heti Fókusz</h4>
                <p>Megdolgozott területek</p>
              </div>
              <div class="body-map-container">
                <div class="body-figure">
                  <div class="bm-part bm-head"></div>
                  <div class="bm-part bm-torso" id="bm-torso" title="Törzs (Mell/Hát/Has)"></div>
                  <div class="bm-part bm-arm-l" id="bm-arms" title="Karok/Váll"></div>
                  <div class="bm-part bm-arm-r"></div>
                  <div class="bm-part bm-leg-l" id="bm-legs" title="Lábak"></div>
                  <div class="bm-part bm-leg-r"></div>
                </div>
              </div>
              <div class="text-center muted small" id="focusText">
                Még nincs adat erre a hétre.
              </div>
            </section>

          </div>
        </div>

        <!-- BUILDER NÉZET – ID igazítva: workoutBuilderView, builderDate -->
        <div id="workoutBuilderView" class="view-section view-hidden">
          <section class="card glass workout-builder">

            <div class="builder-top-nav">
              <button class="ghost small" id="backToCalendarBtn">← Vissza a naptárhoz</button>
              <div class="calendar-current" style="margin:0">
                <span id="builderDate">–</span>
              </div>
            </div>

            <div class="builder-mode">
              <h3>Mit edzettél ma?</h3>
              <div class="mode-buttons">
                <button id="modeCardio" class="btn mode-btn">Kardió</button>
                <button id="modeGym" class="btn mode-btn">Edzőtermi edzés</button>
              </div>
              <p class="muted small" id="dayTypeLabel" style="margin-top:8px; min-height:20px;"></p>
            </div>

            <!-- GYM BUILDER -->
            <div id="gymBuilder" class="builder-body" style="display:none;">
              <div class="builder-header">
                <h3>Gyakorlatválasztó</h3>
                <p class="muted">Húzd be a 3 fő gyakorlatot, majd válassz kiegészítőket.</p>
                <button id="copyPreviousBtn" class="btn-copy" style="display:none;">
                  <span>↺</span> Legutóbbi ilyen nap másolása
                </button>
              </div>

              <div class="builder-section">
                <div class="split-selector" id="splitSelectorContainer">
                  <button class="split-btn" data-type="push">Push</button>
                  <button class="split-btn" data-type="pull">Pull</button>
                  <button class="split-btn" data-type="legs">Legs</button>
                  <button class="split-btn" data-type="mixed">Vegyes</button>
                </div>

                <!-- Rejtett select, hogy a workout.js-ben lévő setupSplitSelector működjön (#dayTypeSelect) -->
                <select id="dayTypeSelect" style="display:none;">
                  <option value="mixed" selected>Vegyes</option>
                  <option value="push">Push</option>
                  <option value="pull">Pull</option>
                  <option value="legs">Legs</option>
                </select>
              </div>

              <div class="input-group" style="margin-top: 15px; margin-bottom: 20px;">
                <label for="gymDurationInput" style="display:block; margin-bottom:5px; color:var(--text-muted); font-size:0.9rem;">
                  Edzés időtartama (perc)
                </label>
                <input
                  type="number"
                  id="gymDurationInput"
                  class="input-field"
                  value="60"
                  min="10"
                  max="300"
                  style="width: 100px; padding: 8px; border-radius: 6px; border: 1px solid #444; background: #222; color: #fff;"
                >
              </div>

              <div class="builder-section">
                <h4>Elérhető gyakorlatok</h4>

                <!-- Kereső mező: ID igazítva a JS-hez (#exerciseSearch) -->
                <div class="input-group" style="margin-bottom:10px;">
                  <input
                    type="text"
                    id="exerciseSearch"
                    class="input-field"
                    placeholder="Gyakorlat keresése..."
                    style="width:100%; padding:8px; border-radius:6px; border:1px solid #444; background:#111; color:#fff;"
                  >
                </div>

                <div class="exercise-pool" id="exercisePool"></div>
              </div>

              <div class="builder-two-col">
                <div class="builder-section">
                  <h4>Fő edzések (max. 3)</h4>
                  <div class="dropzone" id="mainExercises"></div>
                </div>

                <div class="builder-section">
                  <h4 style="display:flex; align-items:center;">
                    Kiegészítők (max. 3)
                    <span class="info-icon" data-tooltip="Okos ajánló: Figyeljük, melyik izomcsoport maradt ki a fő edzésből, és azt pótoljuk először.">i</span>
                  </h4>
                  <div class="dropzone" id="extraExercises"></div>
                </div>
              </div>
            </div>

            <!-- CARDIO BUILDER -->
            <div id="cardioBuilder" class="builder-body" style="display:none;">
              <div class="builder-header">
                <h3>Kardió aktivitás</h3>
              </div>
              <div class="builder-section">
                <div class="cardio-list" id="cardioList"></div>
              </div>
            </div>

            <div class="builder-footer">
              <button class="btn" id="lockDayBtn" disabled>Nap lezárása</button>
              <p class="muted small" id="lockInfo">Válassz aktivitást a mentéshez.</p>
            </div>

          </section>
        </div>

      </div>

      <!-- POPUP – ID-k igazítva: popupContent, startWorkoutBtn -->
      <div id="dayPopup" class="modal-overlay hidden" style="z-index: 200;">
        <div class="modal-content glass" style="max-width: 400px; width: 90%; padding: 24px; border: 2px solid var(--gold-2); box-shadow: 0 0 30px rgba(110, 203, 108, 0.2);">
          <h3
            id="popupDate"
            style="color: var(--gold-2); margin: 0 0 16px 0; text-align: center; border-bottom: 1px solid rgba(255,255,255,0.1); padding-bottom: 10px;"
          >
            Dátum
          </h3>

          <!-- ID igazítva: popupContent -->
          <div id="popupContent" style="margin-bottom: 16px;"></div>

          <!-- Ezt a gombot várja a workout.js: #startWorkoutBtn -->
          <button
            class="btn"
            id="startWorkoutBtn"
            style="width: 100%; margin-bottom: 8px; background: var(--gold-2); color: #05080c; font-weight: 700;"
          >
            Edzés hozzáadása
          </button>

          <button
            class="btn"
            id="closePopupBtn"
            style="width: 100%; background: transparent; border:1px solid var(--gold-2); color: var(--gold-2); font-weight: 600;"
          >
            Bezárás
          </button>
        </div>
      </div>

    </section>
  </main>

  <script src="script.js"></script>
  <script src="workout.js"></script>
</body>
</html>
